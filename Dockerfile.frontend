FROM node:22-alpine

WORKDIR /app

# Copy dependency manifests and install once for build cache
COPY modern-system/package*.json /app/modern-system/
RUN cd /app/modern-system && npm install

# Copy project files
COPY . /app/

# Copy custom entrypoint
COPY docker/frontend-entrypoint.sh /usr/local/bin/frontend-entrypoint.sh
RUN chmod +x /usr/local/bin/frontend-entrypoint.sh

EXPOSE 5173

CMD ["/usr/local/bin/frontend-entrypoint.sh"]